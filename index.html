<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Time Series Quiz - Millionaire Style</title>
  <style>
    :root {
      --bg: #050816;
      --card: #111827;
      --card-soft: #1f2937;
      --accent: #3b82f6;
      --accent-soft: #2563eb;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #f97373;
      --success: #22c55e;
      --border: #374151;
      --shadow: 0 18px 45px rgba(0, 0, 0, 0.55);
      --radius-lg: 18px;
    }

    /* Light theme overrides */
    body.light-theme {
      --bg: #f3f4f6;
      --card: #ffffff;
      --card-soft: #f3f4f6;
      --accent: #2563eb;
      --accent-soft: #3b82f6;
      --text: #111827;
      --muted: #6b7280;
      --danger: #dc2626;
      --success: #16a34a;
      --border: #e5e7eb;
      --shadow: 0 12px 25px rgba(15, 23, 42, 0.12);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 55%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    body.light-theme {
      background: radial-gradient(circle at top, #e5e7eb 0, #f9fafb 50%, #e5e7eb 100%);
    }

    .app {
      width: 100%;
      max-width: 1200px;
      margin: 16px;
      background: linear-gradient(145deg, var(--card) 0, var(--card) 40%, var(--card) 100%);
      border-radius: 24px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(15, 23, 42, 0.96);
      backdrop-filter: blur(12px);
      color: #e5e7eb;
    }

    body.light-theme header {
      background: #111827;
      color: #f9fafb;
    }

    .title {
      font-size: 1.2rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .title span.logo-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px rgba(59, 130, 246, 0.85);
      display: inline-block;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .theme-toggle {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: transparent;
      color: inherit;
      font-size: 0.8rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .student-badge {
      font-size: 0.85rem;
      color: #cbd5f5;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .badge-pill {
      padding: 3px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.8);
    }

    body.light-theme .student-badge {
      color: #e5e7eb;
    }
    body.light-theme .badge-pill {
      background: #1f2937;
      border-color: #4b5563;
    }

    main {
      flex: 1;
      padding: 18px;
      display: flex;
    }

    .screen {
      display: none;
      width: 100%;
    }

    .screen.active {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .card {
      background: radial-gradient(circle at top left, var(--card-soft) 0, var(--card) 55%);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      padding: 20px 22px;
      box-shadow: var(--shadow);
    }

    .card h2 {
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .subtitle {
      margin: 0;
      margin-bottom: 16px;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .input-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 12px;
    }

    label {
      font-size: 0.9rem;
      color: var(--muted);
    }

    input, textarea {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text);
      outline: none;
      font-size: 0.95rem;
      transition: border 0.15s ease, box-shadow 0.15s ease, transform 0.05s ease;
      font-family: inherit;
    }

    body.light-theme input,
    body.light-theme textarea {
      background: #f9fafb;
    }

    input:focus, textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.4);
      transform: translateY(-1px);
    }

    textarea {
      min-height: 80px;
      resize: vertical;
    }

    .error-text {
      color: var(--danger);
      font-size: 0.85rem;
      min-height: 1.1em;
    }

    .btn {
      border-radius: 999px;
      border: 1px solid transparent;
      padding: 10px 20px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease,
        border 0.12s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent-soft), var(--accent));
      color: white;
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.45);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(37, 99, 235, 0.55);
    }

    .btn-secondary {
      background: rgba(15, 23, 42, 0.95);
      color: var(--text);
      border-color: var(--border);
    }

    body.light-theme .btn-secondary {
      background: #f3f4f6;
    }

    .btn-secondary:hover {
      border-color: var(--accent);
    }

    .btn:disabled {
      opacity: 0.45;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .instructions-list {
      margin: 0;
      padding-left: 18px;
      font-size: 0.95rem;
      color: var(--muted);
    }

    .instructions-list li {
      margin-bottom: 6px;
    }

    .quiz-layout {
      display: grid;
      grid-template-columns: minmax(0, 2.2fr) minmax(0, 1fr);
      gap: 16px;
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .question-number {
      font-size: 0.9rem;
      color: var(--muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .question-text {
      font-size: 1rem;
      margin: 0;
      margin-top: 4px;
      line-height: 1.5;
    }

    .options-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
      margin-top: 14px;
    }

    .option-btn {
      width: 100%;
      text-align: left;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.95);
      color: var(--text);
      cursor: pointer;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: transform 0.08s ease, box-shadow 0.08s ease, border 0.12s ease,
        background 0.12s ease;
    }

    body.light-theme .option-btn {
      background: #f9fafb;
    }

    .option-label {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      border: 1px solid var(--border);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: var(--muted);
      flex-shrink: 0;
      background: #020617;
    }

    body.light-theme .option-label {
      background: #e5e7eb;
    }

    .option-btn:hover:not(:disabled) {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.35);
      transform: translateY(-1px);
    }

    .option-btn.correct {
      border-color: var(--success);
      background: radial-gradient(circle at top left, #064e3b 0, #022c22 55%);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.5);
    }
    body.light-theme .option-btn.correct {
      background: #ecfdf3;
    }

    .option-btn.incorrect {
      border-color: var(--danger);
      background: radial-gradient(circle at top left, #4b1a1a 0, #1f0707 55%);
      box-shadow: 0 0 0 1px rgba(248, 113, 113, 0.6);
    }
    body.light-theme .option-btn.incorrect {
      background: #fef2f2;
    }

    .option-btn.disabled-option {
      opacity: 0.35;
      border-style: dashed;
    }

    .quiz-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      gap: 8px;
      flex-wrap: wrap;
    }

    .status-text {
      font-size: 0.9rem;
      color: var(--muted);
      min-height: 1.2em;
    }

    .status-text strong {
      color: var(--accent);
    }

    .lifelines-card {
      background: radial-gradient(circle at top right, var(--card-soft) 0, var(--card) 55%);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      padding: 14px 14px 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .lifelines-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
    }

    .lifelines-header h3 {
      margin: 0;
      font-size: 1rem;
      font-weight: 500;
    }

    .lifelines-header span {
      font-size: 0.75rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .lifelines-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn-lifeline {
      flex: 1;
      min-width: 120px;
      padding-inline: 12px;
      padding-block: 8px;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 999px;
      border: 1px dashed var(--border);
      color: var(--text);
      font-size: 0.9rem;
    }

    body.light-theme .btn-lifeline {
      background: #f9fafb;
    }

    .btn-lifeline-used {
      border-style: solid;
      border-color: #4b5563;
      color: #6b7280;
      background: #020617;
    }
    body.light-theme .btn-lifeline-used {
      background: #e5e7eb;
    }

    .ladder {
      margin: 0;
      padding: 0;
      list-style: none;
      max-height: 320px;
      overflow-y: auto;
      font-size: 0.85rem;
    }

    .ladder li {
      display: flex;
      justify-content: space-between;
      padding: 4px 8px;
      border-radius: 999px;
      margin-bottom: 2px;
      color: var(--muted);
    }

    .ladder li.active {
      background: linear-gradient(135deg, rgba(37, 99, 235, 0.18), rgba(37, 99, 235, 0.4));
      color: var(--text);
      font-weight: 500;
    }

    .ladder li span.qno {
      opacity: 0.85;
    }

    .ladder li span.points {
      font-size: 0.8rem;
      opacity: 0.9;
    }

    .poll {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px dashed var(--border);
    }

    .poll h3 {
      margin: 0 0 4px;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .poll-row {
      display: grid;
      grid-template-columns: auto minmax(0, 1fr) auto;
      align-items: center;
      gap: 6px;
      margin: 2px 0;
      font-size: 0.8rem;
    }

    .poll-label {
      color: var(--muted);
    }

    .poll-bar-wrapper {
      position: relative;
      height: 12px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      overflow: hidden;
      border: 1px solid #1e293b;
    }

    body.light-theme .poll-bar-wrapper {
      background: #e5e7eb;
      border-color: #cbd5f5;
    }

    .poll-bar {
      position: absolute;
      inset: 0;
      width: 0;
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.35), rgba(59, 130, 246, 0.9));
      transition: width 0.35s ease-out;
    }

    .poll-value {
      color: var(--muted);
    }

    .hidden {
      display: none;
    }

    .result-main {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .result-score {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .result-score span {
      color: var(--accent);
    }

    .result-meta {
      font-size: 0.9rem;
      color: var(--muted);
    }

    .result-actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    @media (min-width: 700px) {
      .options-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 768px) {
      main {
        padding: 12px;
      }

      .quiz-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 480px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }

      .title {
        font-size: 1.05rem;
      }
    }
  </style>
</head>
<body class="dark-theme">
  <div class="app">
    <header>
      <div class="title">
        <span class="logo-dot"></span>
        Time Series Quiz ‚Äì Millionaire Mode
      </div>
      <div class="header-right">
        <button id="theme-toggle" class="theme-toggle" type="button">
          üåô Dark
        </button>
        <div class="student-badge">
          <span class="badge-pill">
            <strong id="display-name">Guest</strong>
          </span>
          <span class="badge-pill">
            USN: <span id="display-usn">---</span>
          </span>
        </div>
      </div>
    </header>

    <main>
      <!-- Screen 1: Student details -->
      <section id="student-screen" class="screen active">
        <div class="card">
          <h2>Welcome to the Time Series Quiz</h2>
          <p class="subtitle">
            Enter your registered USN and Name to begin. Only valid students can proceed.
          </p>
          <form id="student-form">
            <div class="input-group">
              <label for="usn">USN</label>
              <input type="text" id="usn" required placeholder="e.g. 1RV20CS123" />
            </div>
            <div class="input-group">
              <label for="name">Name</label>
              <input type="text" id="name" required placeholder="Your full name" />
            </div>
            <div class="error-text" id="login-error"></div>
            <button type="submit" class="btn btn-primary">
              Continue to Instructions ‚Üí
            </button>
          </form>
        </div>
      </section>

      <!-- Screen 2: Instructions -->
      <section id="instructions-screen" class="screen">
        <div class="card">
          <h2>Instructions</h2>
          <p class="subtitle">
            Please read the guidelines carefully before you start. This quiz is designed
            to test <strong>conceptual depth</strong> in Time Series Analysis.
          </p>
          <ul class="instructions-list">
            <li>There are <strong>25 questions</strong>, each with four options.</li>
            <li>You have <strong>two lifelines</strong> for the entire quiz:
              <ul>
                <li><strong>50 : 50</strong> ‚Äì removes two incorrect options.</li>
                <li><strong>Audience Poll</strong> ‚Äì shows voting percentages (the correct
                  answer has the highest percentage).</li>
              </ul>
            </li>
            <li>You can use each lifeline <strong>only once</strong> in the whole quiz.</li>
            <li>Do not refresh, close the tab, or switch devices while attempting.</li>
            <li>Attempt the quiz <strong>honestly</strong> without referring to external material.</li>
            <li>Your score will be shown at the end with your <strong>Name &amp; USN</strong>.</li>
          </ul>
          <button id="start-quiz-btn" class="btn btn-primary" style="margin-top: 10px;">
            I Agree ‚Äì Start Quiz ‚Üí
          </button>
        </div>
      </section>

      <!-- Screen 3: Quiz -->
      <section id="quiz-screen" class="screen">
        <div class="quiz-layout">
          <!-- Left: question and options -->
          <div class="card">
            <div class="question-header">
  		<div>
    			<div class="question-number" id="question-count-label">
      			Question 1 of 25
    			</div>
    			<p class="question-text" id="question-text"></p>
  			</div>
  			<div class="question-number" id="timer-display">
    			Time left: 60:00
  		</div>
		</div>

            <div class="options-grid" id="options-container"></div>
            <div class="quiz-footer">
              <div class="status-text" id="status-text">
                Use a lifeline if you are unsure.
              </div>
              <button id="next-btn" class="btn btn-secondary" disabled>
                Next Question ‚Üí
              </button>
            </div>
          </div>

          <!-- Right: lifelines and ladder -->
          <div class="lifelines-card">
            <div class="lifelines-header">
              <h3>Lifelines</h3>
              <span>Max 1 use each</span>
            </div>
            <div class="lifelines-buttons">
              <button id="lifeline-5050" class="btn btn-lifeline">
                50 : 50
              </button>
              <button id="lifeline-poll" class="btn btn-lifeline">
                Audience Poll
              </button>
            </div>
            <div id="poll-container" class="poll hidden"></div>

            <div style="margin-top: 10px;">
              <div class="question-number" style="margin-bottom: 4px;">
                Question Ladder
              </div>
              <ol class="ladder" id="ladder-list"></ol>
            </div>
          </div>
        </div>
      </section>

      <!-- Screen 4: Result + Feedback -->
      <section id="result-screen" class="screen">
        <div class="card result-main">
          <h2>Quiz Completed</h2>
          <p class="result-score">
            Your Score: <span id="result-score"></span> / 25
          </p>
          <p class="result-meta">
            Candidate: <strong id="result-name"></strong> (USN: <strong id="result-usn"></strong>)
          </p>
          <p class="subtitle">
            Thank you for attempting this Time Series quiz. Your result has been recorded.
            Please share your suggestions and feedback below.
          </p>

          <div class="input-group">
            <label for="feedback-text">Suggestion / Feedback on quiz</label>
            <textarea id="feedback-text" placeholder="What should be improved? Was it too easy / hard?"></textarea>
          </div>

          <div class="input-group">
            <label for="feedback-rating">Overall experience (1 = Poor, 5 = Excellent)</label>
            <input id="feedback-rating" type="number" min="1" max="5" placeholder="1 to 5" />
          </div>

          <div class="error-text" id="feedback-status"></div>

          <div class="result-actions">
            <button id="submit-feedback-btn" class="btn btn-primary">
              Submit Feedback & Finish
            </button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // ---------------------------------
    // CONFIG / CONSTANTS
    // ---------------------------------
    const RESULTS_KEY = "ts_quiz_results_v2";

    // TODO: Replace these URLs with your backend endpoints
    const RESULTS_API_URL = "https://your-backend.example.com/api/results";
    const FEEDBACK_API_URL = "https://your-backend.example.com/api/feedback";

    // ---------------------------------
    // STUDENT LIST (LOGIN VERIFICATION)
    // ---------------------------------
    // TODO: Replace this with your real list.
    // Use EXACT USN and Name (you can convert to upper/lower case while matching).
    const allowedStudents = [
  { usn: "1BM22CD010", name: "ARYA" },
  { usn: "1BM22CD068", name: "VARUN" },
  { usn: "1BM23CD002", name: "Abhigna" },
  { usn: "1BM23CD003", name: "ABHIJITH" },
  { usn: "1BM23CD004", name: "ACHINTYA" },
  { usn: "1BM23CD005", name: "Alvin" },
  { usn: "1BM23CD006", name: "ANIKETH" },
  { usn: "1BM23CD007", name: "Arunank" },
  { usn: "1BM23CD008", name: "ARYAN" },
  { usn: "1BM23CD009", name: "Athish" },
  { usn: "1BM23CD010", name: "Bhoomika" },
  { usn: "1BM23CD011", name: "KRITHI" },
  { usn: "1BM23CD012", name: "Chinmayee" },
  { usn: "1BM23CD013", name: "CHIRAG" },
  { usn: "1BM23CD014", name: "DANI" },
  { usn: "1BM23CD015", name: "DEEPTHI" },
  { usn: "1BM23CD016", name: "DINESH" },
  { usn: "1BM23CD017", name: "DIVAN" },
  { usn: "1BM23CD018", name: "SHREEKAR" },
  { usn: "1BM23CD019", name: "GULSHAN" },
  { usn: "1BM23CD020", name: "SAMPREETH" },
  { usn: "1BM23CD021", name: "HEMANTH" },
  { usn: "1BM23CD022", name: "Hemanth" },
  { usn: "1BM23CD023", name: "HIMASHREE" },
  { usn: "1BM23CD025", name: "KESHIKA" },
  { usn: "1BM23CD026", name: "KHUSHI" },
  { usn: "1BM23CD027", name: "KODURU" },
  { usn: "1BM23CD028", name: "KRUTI" },
  { usn: "1BM23CD029", name: "KUMAR" },
  { usn: "1BM23CD030", name: "KUSHAL" },
  { usn: "1BM23CD031", name: "LAKSHYA" },
  { usn: "1BM23CD033", name: "MADHAV" },
  { usn: "1BM23CD034", name: "MANAS" },
  { usn: "1BM23CD035", name: "MANOHARA" },
  { usn: "1BM23CD037", name: "MAYUR" },
  { usn: "1BM23CD038", name: "MILAN" },
  { usn: "1BM23CD039", name: "ARSHAQ" },
  { usn: "1BM23CD040", name: "NAZEEF" },
  { usn: "1BM23CD041", name: "NEOLA" },
  { usn: "1BM23CD042", name: "ORWIN" },
  { usn: "1BM23CD043", name: "Pavithra" },
  { usn: "1BM23CD044", name: "PRAJWAL" },
  { usn: "1BM23CD045", name: "pramod" },
  { usn: "1BM23CD047", name: "ABHISHEK" },
  { usn: "1BM23CD048", name: "RAHUL" },
  { usn: "1BM23CD049", name: "RICHAL" },
  { usn: "1BM23CD050", name: "RICHIK" },
  { usn: "1BM23CD051", name: "ROHAN" },
  { usn: "1BM23CD052", name: "ROWEENA" },
  { usn: "1BM23CD053", name: "S SANJAY" },
  { usn: "1BM23CD054", name: "SANCHIT" },
  { usn: "1BM23CD055", name: "SHARANYA" },
  { usn: "1BM23CD057", name: "SHREEJIT" },
  { usn: "1BM23CD058", name: "Shreyas" },
  { usn: "1BM23CD059", name: "SOHAM" },
  { usn: "1BM23CD060", name: "SRIJAN" },
  { usn: "1BM23CD061", name: "SURAJ" },
  { usn: "1BM23CD062", name: "SUSHANT" },
  { usn: "1BM23CD063", name: "Sushanth" },
  { usn: "1BM23CD064", name: "TANUSH" },
  { usn: "1BM23CD065", name: "Taran" },
  { usn: "1BM23CD066", name: "TRISHUL J" },
  { usn: "1BM23CD067", name: "ULLAS N" },
  { usn: "1BM23CD069", name: "VEDANTHA" },
  { usn: "1BM23CD070", name: "YASH" },
  { usn: "1BM23CD071", name: "YASSER" },
  { usn: "1BM23CD072", name: "SHAKTHI" },
  { usn: "1BM23CD073", name: "AYUSH" },
  { usn: "1BM23CD074", name: "SHASHANK" },
  { usn: "1BM23CD075", name: "AYUSH" },
  { usn: "1BM24CD400", name: "GEETHA" },
  { usn: "1BM24CD401", name: "KASHISH" },
  { usn: "1BM24CD402", name: "PRIYANKA" },
  { usn: "1BM24CD404", name: "SUMATHI" },
  { usn: "1BM24CD405", name: "SUSHMITA" }
];


    function normalize(str) {
      return str.trim().toUpperCase().replace(/\s+/g, " ");
    }

    function validateStudent(usn, name) {
      const nUSN = normalize(usn);
      const nName = normalize(name);
      return allowedStudents.some(
        (s) => normalize(s.usn) === nUSN && normalize(s.name) === nName
      );
    }

    // ---------------------------------
    // Question bank (same as before)
    // correctIndex is 0 but options
    // will be shuffled per student.
    // ---------------------------------
    const questions = [
      {
        question:
          "1. A weakly stationary time series {X_t} must satisfy which of the following conditions?",
        options: [
          "E[X_t] is constant and Cov(X_s, X_t) depends only on |t‚àís|",
          "E[X_t] and Cov(X_s, X_t) are both arbitrary functions of time",
          "Var(X_t) grows without bound as t increases",
          "E[X_t] is linear in t but Cov(X_s, X_t) is constant"
        ],
        correctIndex: 0
      },
      {
        question:
          "2. An additive decomposition model is generally preferred over a multiplicative one when:",
        options: [
          "Seasonal variation is roughly constant in absolute size across time",
          "Seasonal variation grows in proportion to the level of the series",
          "The series contains a unit root",
          "The series has purely cyclical but no trend component"
        ],
        correctIndex: 0
      },
      {
        question:
          "3. For a time series, the autocorrelation function (ACF) at lag k is defined conceptually as:",
        options: [
          "Cov(X_t, X_{t+k}) divided by Var(X_t)",
          "Cov(X_t, X_{t+k}) minus Var(X_t)",
          "Var(X_t) divided by Cov(X_t, X_{t+k})",
          "Cov(X_t, X_{t+k}) divided by E[X_t]"
        ],
        correctIndex: 0
      },
      {
        question:
          "4. In a vector-valued time series {Y_t}, with Y_t = (Y_{1t}, Y_{2t})', which statement is most accurate?",
        options: [
          "Cross-covariance between Y_{1t} and Y_{2,t+k} captures dependence across components and lags",
          "Autocorrelation is undefined for vector-valued series",
          "Each component must be modeled completely independently",
          "Stationarity is impossible for multivariate time series"
        ],
        correctIndex: 0
      },
      {
        question:
          "5. Among the following methods of measuring trend, which is most sensitive to local short-run fluctuations?",
        options: [
          "Moving average method",
          "Graphic method",
          "Least squares regression trend",
          "Semi-averages method"
        ],
        correctIndex: 0
      },
      {
        question:
          "6. The Ratio-to-Moving Average method for seasonal indices primarily assumes that:",
        options: [
          "Trend and seasonality interact multiplicatively",
          "Trend and seasonality interact additively",
          "There is no trend in the series at all",
          "Cycles are stronger than seasonality"
        ],
        correctIndex: 0
      },
      {
        question:
          "7. The Variate Difference method is mainly used in time series analysis to:",
        options: [
          "Highlight short-period fluctuations by differencing successive values",
          "Estimate long-run deterministic trend",
          "Remove both trend and seasonality simultaneously",
          "Directly compute index numbers from raw values"
        ],
        correctIndex: 0
      },
      {
        question:
          "8. Which statement regarding Laspeyres and Paasche price indices is correct?",
        options: [
          "Laspeyres uses base-period quantities; Paasche uses current-period quantities",
          "Both Laspeyres and Paasche use current-period quantities",
          "Laspeyres uses current-period quantities; Paasche uses base-period quantities",
          "Both indices always yield identical values"
        ],
        correctIndex: 0
      },
      {
        question:
          "9. Fisher‚Äôs Ideal Index Number is often preferred theoretically because:",
        options: [
          "It is the geometric mean of Laspeyres and Paasche and satisfies important tests",
          "It ignores quantity changes completely",
          "It uses only base-year quantities for weighting",
          "It is always numerically larger than both Laspeyres and Paasche"
        ],
        correctIndex: 0
      },
      {
        question:
          "10. A Cost of Living Index Number conceptually measures:",
        options: [
          "The change in minimum expenditure needed to maintain a given standard of living",
          "The change in total national income",
          "Only the change in food prices over time",
          "Only changes in wages in the industrial sector"
        ],
        correctIndex: 0
      },
      {
        question:
          "11. In the Bass diffusion model, the two key parameters usually interpreted are:",
        options: [
          "Innovation effect and imitation effect",
          "Trend coefficient and seasonal coefficient",
          "Autoregressive and moving average coefficients",
          "Mean and variance of white noise"
        ],
        correctIndex: 0
      },
      {
        question:
          "12. In simple exponential smoothing, using a very high smoothing constant Œ± (close to 1) will:",
        options: [
          "Make forecasts react strongly to the most recent observation",
          "Make forecasts almost equal to the long-run historical mean",
          "Completely remove random noise",
          "Automatically incorporate seasonality"
        ],
        correctIndex: 0
      },
      {
        question:
          "13. The multiplicative Holt‚ÄìWinters method is especially suitable when:",
        options: [
          "Seasonal amplitudes grow roughly in proportion to the trend level",
          "Seasonal variation is constant in absolute magnitude",
          "No trend is present, only random noise",
          "There are only cyclical fluctuations and no seasonality"
        ],
        correctIndex: 0
      },
      {
        question:
          "14. For a pure white noise process {Œµ_t}, which statement about its autocorrelation function (ACF) is correct?",
        options: [
          "œÅ(0)=1 and œÅ(k)=0 for all non-zero lags k",
          "œÅ(k) decays slowly and geometrically with k",
          "œÅ(k) is 1 for all lags",
          "œÅ(k) alternates exactly between +1 and ‚àí1"
        ],
        correctIndex: 0
      },
      {
        question:
          "15. An AR(1) process X_t = œÜ X_{t‚àí1} + Œµ_t is weakly stationary only if:",
        options: [
          "|œÜ| < 1",
          "|œÜ| = 1",
          "|œÜ| > 1",
          "œÜ is exactly zero"
        ],
        correctIndex: 0
      },
      {
        question:
          "16. A key identifying feature of a pure MA(q) model in terms of ACF and PACF is:",
        options: [
          "ACF cuts off after lag q, PACF tails off gradually",
          "PACF cuts off after lag q, ACF tails off gradually",
          "Both ACF and PACF tail off gradually",
          "Both ACF and PACF cut off after the same lag"
        ],
        correctIndex: 0
      },
      {
        question:
          "17. In time series regression, Generalized Least Squares (GLS) is used primarily to:",
        options: [
          "Handle autocorrelated and/or heteroskedastic errors efficiently",
          "Force residuals to be exactly zero",
          "Guarantee that the series becomes stationary",
          "Automatically choose ARIMA orders"
        ],
        correctIndex: 0
      },
      {
        question:
          "18. A harmonic seasonal model typically represents seasonality by:",
        options: [
          "Sine and cosine terms with frequencies corresponding to seasonal periods",
          "Random walks with seasonal drift",
          "Polynomials of very high order in time t",
          "Only dummy variables for seasons"
        ],
        correctIndex: 0
      },
      {
        question:
          "19. Applying a logarithmic transform to a strictly positive time series is often done to:",
        options: [
          "Stabilize variance and convert multiplicative effects into additive effects",
          "Introduce additional seasonality into the series",
          "Guarantee normality of the data",
          "Eliminate all autocorrelation"
        ],
        correctIndex: 0
      },
      {
        question:
          "20. In a pure MA(1) model X_t = Œµ_t + Œ∏ Œµ_{t‚àí1}, the theoretical ACF:",
        options: [
          "Is non-zero only at lag 0 and lag 1",
          "Is non-zero at all lags but decays exponentially",
          "Is non-zero only at even lags",
          "Is zero at lag 1"
        ],
        correctIndex: 0
      },
      {
        question:
          "21. In an ARIMA(p, d, q) model, the parameter d specifically represents:",
        options: [
          "The order of differencing used to remove non-stationarity",
          "The degree of seasonality in the series",
          "The number of moving average parameters",
          "The number of autoregressive parameters"
        ],
        correctIndex: 0
      },
      {
        question:
          "22. A standard approach to building a non-seasonal ARIMA model typically follows which logical sequence?",
        options: [
          "Identification ‚Üí Estimation ‚Üí Diagnostic checking",
          "Estimation ‚Üí Identification ‚Üí Diagnostic checking",
          "Diagnostic checking ‚Üí Estimation ‚Üí Identification",
          "Identification ‚Üí Diagnostic checking ‚Üí Estimation"
        ],
        correctIndex: 0
      },
      {
        question:
          "23. In an ARCH(1) model, the conditional variance at time t usually depends on:",
        options: [
          "A constant term plus a multiple of the previous squared error",
          "Only a constant term",
          "Only the current error term",
          "The sum of all past residuals without squaring"
        ],
        correctIndex: 0
      },
      {
        question:
          "24. A GARCH(1,1) model extends ARCH(1) by:",
        options: [
          "Including both lagged squared errors and lagged conditional variances",
          "Eliminating dependence on past variances",
          "Ignoring the mean equation entirely",
          "Making the variance constant over time"
        ],
        correctIndex: 0
      },
      {
        question:
          "25. A strong indication that an ARCH/GARCH model is needed for a fitted ARIMA model arises when:",
        options: [
          "Squared residuals exhibit significant autocorrelation",
          "Residuals have exactly zero mean",
          "The ACF of raw data is zero at all lags",
          "There is a deterministic linear trend in the series"
        ],
        correctIndex: 0
      }
    ];

    // ---------------------------------
    // STATE
    // ---------------------------------
    let studentName = "";
    let studentUSN = "";
    let currentQuestionIndex = 0;
    let score = 0;
    let used5050 = false;
    let usedPoll = false;
    let questionAnswered = false;
    let quizFinished = false;
    let timerIntervalId = null;
    const TOTAL_TIME_SECONDS = 60 * 60; // 60 minutes
    let remainingSeconds = TOTAL_TIME_SECONDS;


    let quizQuestions = [];
    let currentOptionsOrder = [];
    let prng = Math.random;

    // ---------------------------------
    // THEME HANDLER
    // ---------------------------------
    function initTheme() {
      const stored = localStorage.getItem("ts_quiz_theme");
      if (stored === "light") {
        document.body.classList.add("light-theme");
      } else {
        document.body.classList.remove("light-theme");
      }
      updateThemeToggleLabel();
    }

    function toggleTheme() {
      document.body.classList.toggle("light-theme");
      const isLight = document.body.classList.contains("light-theme");
      localStorage.setItem("ts_quiz_theme", isLight ? "light" : "dark");
      updateThemeToggleLabel();
    }

    function updateThemeToggleLabel() {
      const btn = document.getElementById("theme-toggle");
      if (!btn) return;
      const isLight = document.body.classList.contains("light-theme");
      btn.textContent = isLight ? "‚òÄÔ∏è Light" : "üåô Dark";
    }

    // ---------------------------------
    // PRNG & SHUFFLING
    // ---------------------------------
    function stringToSeed(str) {
      let h = 0;
      for (let i = 0; i < str.length; i++) {
        h = (h << 5) - h + str.charCodeAt(i);
        h |= 0;
      }
      return (h >>> 0) || 123456789;
    }

    function createPRNG(seed) {
      let s = seed >>> 0;
      return function () {
        s ^= s << 13;
        s ^= s >>> 17;
        s ^= s << 5;
        s >>>= 0;
        return s / 4294967296;
      };
    }

    function random() {
      return prng();
    }

    function randomInt(min, max) {
      return Math.floor(random() * (max - min + 1)) + min;
    }

    function showScreen(id) {
      document.querySelectorAll(".screen").forEach((s) => {
        s.classList.toggle("active", s.id === id);
      });
    }

    // Ladder
    function buildLadder() {
      const ladderList = document.getElementById("ladder-list");
      ladderList.innerHTML = "";
      for (let i = 0; i < questions.length; i++) {
        const li = document.createElement("li");
        const qSpan = document.createElement("span");
        qSpan.className = "qno";
        qSpan.textContent = `Q${i + 1}`;
        const pSpan = document.createElement("span");
        pSpan.className = "points";
        pSpan.textContent = `${i + 1}`;
        li.appendChild(qSpan);
        li.appendChild(pSpan);
        ladderList.appendChild(li);
      }
    }

    function updateLadderHighlight() {
        const ladderItems = document.querySelectorAll("#ladder-list li");
        ladderItems.forEach((li, idx) => {
          li.classList.toggle("active", idx === currentQuestionIndex);
        });
      }
      
      function updateTimerDisplay() {
      const el = document.getElementById("timer-display");
      if (!el) return;
      const mins = Math.floor(remainingSeconds / 60);
      const secs = remainingSeconds % 60;
      const mm = String(mins).padStart(2, "0");
      const ss = String(secs).padStart(2, "0");
      el.textContent = `Time left: ${mm}:${ss}`;
    }

    function handleTimeUp() {
      if (quizFinished) return; // already submitted
      const statusText = document.getElementById("status-text");
      if (statusText) {
        statusText.innerHTML = "<strong>Time is up.</strong> Submitting your quiz...";
      }
      // prevent further interaction
      const optionButtons = document.querySelectorAll(".option-btn");
      optionButtons.forEach((btn) => (btn.disabled = true));
      const nextBtn = document.getElementById("next-btn");
      if (nextBtn) nextBtn.disabled = true;

      showResult();
    }

    function startTimer() {
      remainingSeconds = TOTAL_TIME_SECONDS;
      updateTimerDisplay();

      if (timerIntervalId) {
        clearInterval(timerIntervalId);
      }

      timerIntervalId = setInterval(() => {
        remainingSeconds--;
        if (remainingSeconds <= 0) {
          remainingSeconds = 0;
          updateTimerDisplay();
          clearInterval(timerIntervalId);
          timerIntervalId = null;
          handleTimeUp();
        } else {
          updateTimerDisplay();
        }
      }, 1000);
    }


    // ---------------------------------
    // QUIZ RENDERING
    // ---------------------------------
    function loadQuestion() {
      const qObj = quizQuestions[currentQuestionIndex];
      const qTextEl = document.getElementById("question-text");
      const qCountLabel = document.getElementById("question-count-label");
      const optionsContainer = document.getElementById("options-container");
      const statusText = document.getElementById("status-text");
      const nextBtn = document.getElementById("next-btn");
      const pollContainer = document.getElementById("poll-container");

      questionAnswered = false;

      qTextEl.textContent = qObj.question;
      qCountLabel.textContent = `Question ${currentQuestionIndex + 1} of ${
        quizQuestions.length
      }`;

      currentOptionsOrder = [0, 1, 2, 3];
      for (let i = currentOptionsOrder.length - 1; i > 0; i--) {
        const j = Math.floor(random() * (i + 1));
        [currentOptionsOrder[i], currentOptionsOrder[j]] = [
          currentOptionsOrder[j],
          currentOptionsOrder[i]
        ];
      }

      optionsContainer.innerHTML = "";
      currentOptionsOrder.forEach((originalIndex, displayIndex) => {
        const optText = qObj.options[originalIndex];

        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "option-btn";
        btn.dataset.displayIndex = displayIndex;
        btn.dataset.originalIndex = originalIndex;

        const label = document.createElement("span");
        label.className = "option-label";
        label.textContent = String.fromCharCode(65 + displayIndex);

        const textSpan = document.createElement("span");
        textSpan.textContent = optText;

        btn.appendChild(label);
        btn.appendChild(textSpan);

        btn.addEventListener("click", () => handleOptionClick(displayIndex));

        optionsContainer.appendChild(btn);
      });

      statusText.innerHTML = "Use a lifeline if you are unsure.";
      nextBtn.disabled = true;

      pollContainer.classList.add("hidden");
      pollContainer.innerHTML = "";

      const btn5050 = document.getElementById("lifeline-5050");
      const btnPoll = document.getElementById("lifeline-poll");

      if (used5050) {
        btn5050.disabled = true;
        btn5050.classList.add("btn-lifeline-used");
      } else {
        btn5050.disabled = false;
      }

      if (usedPoll) {
        btnPoll.disabled = true;
        btnPoll.classList.add("btn-lifeline-used");
      } else {
        btnPoll.disabled = false;
      }

      updateLadderHighlight();
    }

    function handleOptionClick(displayIndex) {
      if (questionAnswered) return;
      questionAnswered = true;

      const qObj = quizQuestions[currentQuestionIndex];
      const correctOriginalIndex = qObj.correctIndex;

      const originalIndex = currentOptionsOrder[displayIndex];
      const correctDisplayIndex = currentOptionsOrder.indexOf(correctOriginalIndex);

      const optionButtons = document.querySelectorAll(".option-btn");
      optionButtons.forEach((btn) => {
        btn.disabled = true;
      });

      const statusText = document.getElementById("status-text");
      if (originalIndex === correctOriginalIndex) {
        score++;
        statusText.innerHTML = "<strong>Correct!</strong> Well done.";
      } else {
        statusText.innerHTML =
          "<strong>Incorrect.</strong> The correct option is highlighted in green.";
      }

      optionButtons.forEach((btn) => {
        const dIdx = parseInt(btn.dataset.displayIndex, 10);
        if (dIdx === correctDisplayIndex) {
          btn.classList.add("correct");
        } else if (dIdx === displayIndex) {
          btn.classList.add("incorrect");
        }
      });

      const nextBtn = document.getElementById("next-btn");
      nextBtn.disabled = false;
      nextBtn.textContent =
        currentQuestionIndex === quizQuestions.length - 1
          ? "View Result"
          : "Next Question ‚Üí";
    }

    // ---------------------------------
    // LIFELINES
    // ---------------------------------
    function use5050() {
      if (used5050 || questionAnswered) return;
      used5050 = true;

      const btn5050 = document.getElementById("lifeline-5050");
      btn5050.disabled = true;
      btn5050.classList.add("btn-lifeline-used");

      const qObj = quizQuestions[currentQuestionIndex];
      const correctOriginalIndex = qObj.correctIndex;
      const correctDisplayIndex = currentOptionsOrder.indexOf(correctOriginalIndex);

      const optionButtons = document.querySelectorAll(".option-btn");
      const wrongDisplayIndices = [0, 1, 2, 3].filter(
        (dIdx) => dIdx !== correctDisplayIndex
      );

      for (let i = wrongDisplayIndices.length - 1; i > 0; i--) {
        const j = Math.floor(random() * (i + 1));
        [wrongDisplayIndices[i], wrongDisplayIndices[j]] = [
          wrongDisplayIndices[j],
          wrongDisplayIndices[i]
        ];
      }

      const toDisable = wrongDisplayIndices.slice(0, 2);
      toDisable.forEach((dIdx) => {
        optionButtons.forEach((btn) => {
          if (parseInt(btn.dataset.displayIndex, 10) === dIdx) {
            btn.classList.add("disabled-option");
            btn.disabled = true;
          }
        });
      });
    }

    function generatePollData(correctDisplayIndex) {
      const perc = [0, 0, 0, 0];
      const correctShare = randomInt(55, 80);
      perc[correctDisplayIndex] = correctShare;
      let remaining = 100 - correctShare;
      const otherDisplayIndices = [0, 1, 2, 3].filter(
        (i) => i !== correctDisplayIndex
      );

      for (let i = 0; i < otherDisplayIndices.length; i++) {
        const idx = otherDisplayIndices[i];
        if (i === otherDisplayIndices.length - 1) {
          perc[idx] = remaining;
        } else {
          const maxPossible = Math.max(
            5,
            remaining - 5 * (otherDisplayIndices.length - 1 - i)
          );
          let val = randomInt(5, maxPossible);
          if (val > remaining) val = remaining;
          remaining -= val;
          perc[idx] = val;
        }
      }
      return perc;
    }

    function renderPoll(perc) {
      const pollContainer = document.getElementById("poll-container");
      pollContainer.innerHTML = "<h3>Audience Poll</h3>";
      perc.forEach((p, idx) => {
        const row = document.createElement("div");
        row.className = "poll-row";

        const label = document.createElement("span");
        label.className = "poll-label";
        label.textContent = String.fromCharCode(65 + idx) + ":";

        const barWrapper = document.createElement("div");
        barWrapper.className = "poll-bar-wrapper";

        const bar = document.createElement("div");
        bar.className = "poll-bar";
        bar.style.width = p + "%";

        const value = document.createElement("span");
        value.className = "poll-value";
        value.textContent = p + "%";

        barWrapper.appendChild(bar);
        row.appendChild(label);
        row.appendChild(barWrapper);
        row.appendChild(value);
        pollContainer.appendChild(row);
      });
      pollContainer.classList.remove("hidden");
    }

    function usePoll() {
      if (usedPoll || questionAnswered) return;
      usedPoll = true;

      const btnPoll = document.getElementById("lifeline-poll");
      btnPoll.disabled = true;
      btnPoll.classList.add("btn-lifeline-used");

      const qObj = quizQuestions[currentQuestionIndex];
      const correctDisplayIndex = currentOptionsOrder.indexOf(qObj.correctIndex);

      const perc = generatePollData(correctDisplayIndex);
      renderPoll(perc);
    }

    // ---------------------------------
    // RESULTS & BACKEND SAVE
    // ---------------------------------
    function storeResultLocally() {
      const raw = localStorage.getItem(RESULTS_KEY);
      let arr = [];
      if (raw) {
        try {
          arr = JSON.parse(raw);
          if (!Array.isArray(arr)) arr = [];
        } catch {
          arr = [];
        }
      }
      arr.push({
        usn: studentUSN,
        name: studentName,
        score: score,
        total: quizQuestions.length,
        timestamp: new Date().toISOString()
      });
      localStorage.setItem(RESULTS_KEY, JSON.stringify(arr));
    }

    async function sendResultToBackend() {
      const payload = {
        usn: studentUSN,
        name: studentName,
        score: score,
        total: quizQuestions.length,
        timestamp: new Date().toISOString()
      };
      try {
        await fetch(RESULTS_API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
      } catch (err) {
        console.error("Error sending result to backend:", err);
      }
    }

    async function sendFeedbackToBackend(feedbackText, rating) {
      const payload = {
        usn: studentUSN,
        name: studentName,
        feedback: feedbackText,
        rating: rating,
        timestamp: new Date().toISOString()
      };
      try {
        const res = await fetch(FEEDBACK_API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });
        return res.ok;
      } catch (err) {
        console.error("Error sending feedback:", err);
        return false;
      }
    }

    function showResult() {

      if (quizFinished) return;      // üîπ prevent double submission
      quizFinished = true;

      if (timerIntervalId) {         // üîπ stop timer if still running
        clearInterval(timerIntervalId);
        timerIntervalId = null;
      }
      // Save result locally and remotely
      storeResultLocally();
      sendResultToBackend();

      document.getElementById("result-score").textContent = score;
      document.getElementById("result-name").textContent = studentName || "Guest";
      document.getElementById("result-usn").textContent = studentUSN || "---";
      showScreen("result-screen");
    }

    function resetQuizState() {
      const seedSource = studentUSN || studentName || "guest-" + Date.now();
      const seed = stringToSeed(seedSource);
      prng = createPRNG(seed);

      quizQuestions = [...questions];
      for (let i = quizQuestions.length - 1; i > 0; i--) {
        const j = Math.floor(random() * (i + 1));
        [quizQuestions[i], quizQuestions[j]] = [quizQuestions[j], quizQuestions[i]];
      }

      currentQuestionIndex = 0;
      score = 0;
      used5050 = false;
      usedPoll = false;
      questionAnswered = false;
      quizFinished = false;          // üîπ add this
      remainingSeconds = TOTAL_TIME_SECONDS; // üîπ reset timer value

      const pollContainer = document.getElementById("poll-container");
      if (pollContainer) {
        pollContainer.classList.add("hidden");
        pollContainer.innerHTML = "";
      }

      loadQuestion();
    }


    // ---------------------------------
    // EVENTS
    // ---------------------------------
    document.addEventListener("DOMContentLoaded", () => {
      initTheme();
      buildLadder();
      updateLadderHighlight();

      const studentForm = document.getElementById("student-form");
      const startQuizBtn = document.getElementById("start-quiz-btn");
      const nextBtn = document.getElementById("next-btn");
      const btn5050 = document.getElementById("lifeline-5050");
      const btnPoll = document.getElementById("lifeline-poll");
      const themeToggle = document.getElementById("theme-toggle");
      const submitFeedbackBtn = document.getElementById("submit-feedback-btn");

      themeToggle.addEventListener("click", toggleTheme);

      studentForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const usnInput = document.getElementById("usn");
        const nameInput = document.getElementById("name");
        const errorEl = document.getElementById("login-error");

        const usn = usnInput.value.trim();
        const name = nameInput.value.trim();

        if (!usn || !name) {
          errorEl.textContent = "Please enter both USN and Name.";
          return;
        }

        if (!validateStudent(usn, name)) {
          errorEl.textContent = "USN / Name not found in the registered list.";
          return;
        }

        errorEl.textContent = "";
        studentUSN = usn;
        studentName = name;

        document.getElementById("display-name").textContent = studentName;
        document.getElementById("display-usn").textContent = studentUSN;

        showScreen("instructions-screen");
      });

      startQuizBtn.addEventListener("click", () => {
        resetQuizState();
        showScreen("quiz-screen");
        startTimer(); // üîπ start 60-minute countdown
      });



      nextBtn.addEventListener("click", () => {
        if (currentQuestionIndex < quizQuestions.length - 1) {
          currentQuestionIndex++;
          loadQuestion();
        } else {
          showResult();
        }
      });

      btn5050.addEventListener("click", use5050);
      btnPoll.addEventListener("click", usePoll);

      submitFeedbackBtn.addEventListener("click", async () => {
        const feedbackText = document.getElementById("feedback-text").value.trim();
        const ratingValue = document.getElementById("feedback-rating").value.trim();
        const statusEl = document.getElementById("feedback-status");

        const rating = ratingValue ? parseInt(ratingValue, 10) : null;
        if (rating && (rating < 1 || rating > 5)) {
          statusEl.textContent = "Rating must be between 1 and 5.";
          return;
        }

        statusEl.textContent = "Submitting feedback...";
        submitFeedbackBtn.disabled = true;

        const ok = await sendFeedbackToBackend(feedbackText, rating);
        if (ok) {
          statusEl.textContent = "Thank you! Your feedback has been recorded.";
        } else {
          statusEl.textContent = "Could not send feedback to server (stored only locally / in logs).";
        }
      });
    });
  </script>

<script>
    // üîí Simple anti-cheat deterrents (not foolproof)

    // Disable right-click context menu
    document.addEventListener("contextmenu", function (e) {
      e.preventDefault();
    });

    // Block some common DevTools keyboard shortcuts
    document.addEventListener("keydown", function (e) {
      // F12
      if (e.key === "F12") {
        e.preventDefault();
      }

      // Ctrl+Shift+I / Ctrl+Shift+J / Ctrl+Shift+C
      if (e.ctrlKey && e.shiftKey) {
        const key = e.key.toUpperCase();
        if (key === "I" || key === "J" || key === "C") {
          e.preventDefault();
        }
      }

      // Ctrl+U (view source)
      if (e.ctrlKey && e.key.toUpperCase() === "U") {
        e.preventDefault();
      }
    });
  </script>

</body>
</html>
